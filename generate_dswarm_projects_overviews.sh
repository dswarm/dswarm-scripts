#!/bin/bash

cat project.* | jq -c '{name: .name, uuid: .uuid, input_data_model_uuid: .input_data_model.uuid, input_data_model_name: .input_data_model.name, input_schema_uuid: .input_data_model.schema.uuid, input_schema_name: .input_data_model.schema.name, output_data_model_uuid: .output_data_model.uuid, output_data_model_name: .output_data_model.name, output_schema_uuid: .output_data_model.schema.uuid, output_schema_name: .output_data_model.schema.name,mappings_count: .mappings | length}' | json2csv -k uuid,name,input_data_model_uuid,input_data_model_name,input_schema_uuid,input_schema_name,output_data_model_uuid,output_data_model_name,output_schema_uuid,output_schema_name,mappings_count -p > ../projects_overview.csv
cat project.* | jq -c '{name: .name, uuid: .uuid, input_data_model_uuid: .input_data_model.uuid, input_data_model_name: .input_data_model.name, input_schema_uuid: .input_data_model.schema.uuid, input_schema_name: .input_data_model.schema.name, output_data_model_uuid: .output_data_model.uuid, output_data_model_name: .output_data_model.name, output_schema_uuid: .output_data_model.schema.uuid, output_schema_name: .output_data_model.schema.name, mappings_count: .mappings | length, mappings: [.mappings[].name]}' > ../projects_overview.ldj
cat project.* | jq '{name: .name, uuid: .uuid, input_data_model_uuid: .input_data_model.uuid, input_data_model_name: .input_data_model.name, input_schema_uuid: .input_data_model.schema.uuid, input_schema_name: .input_data_model.schema.name, output_data_model_uuid: .output_data_model.uuid, output_data_model_name: .output_data_model.name, output_schema_uuid: .output_data_model.schema.uuid, output_schema_name: .output_data_model.schema.name, mappings_count: .mappings | length, mappings: [.mappings[].name]}' > ../projects_overview.jsons
